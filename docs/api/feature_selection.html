<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.0"/>
    <title>turkish_music_emotion.feature_selection API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../turkish_music_emotion.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;turkish_music_emotion</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#FeatureSelector">FeatureSelector</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FeatureSelector.__init__">FeatureSelector</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureSelector.data_dir">data_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureSelector.processed_data_path">processed_data_path</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureSelector.feature_selected_data_path">feature_selected_data_path</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureSelector.df">df</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureSelector.X">X</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureSelector.y">y</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureSelector.le">le</a>
                        </li>
                        <li>
                                <a class="variable" href="#FeatureSelector.y_encoded">y_encoded</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureSelector.variance_threshold_selection">variance_threshold_selection</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureSelector.correlation_analysis">correlation_analysis</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureSelector.mutual_information_selection">mutual_information_selection</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureSelector.random_forest_importance">random_forest_importance</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureSelector.plot_feature_importances">plot_feature_importances</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureSelector.select_features">select_features</a>
                        </li>
                        <li>
                                <a class="function" href="#FeatureSelector.save_selected_features">save_selected_features</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../turkish_music_emotion.html">turkish_music_emotion</a><wbr>.feature_selection    </h1>

                        <div class="docstring"><p>Módulo de Selección de Características para Clasificación de Emociones en Música Turca.</p>

<p>Este módulo proporciona un pipeline completo de selección de características que combina
múltiples métodos para identificar las características más relevantes para la clasificación
de emociones en música turca. Los métodos incluyen:</p>

<ul>
<li>Filtrado por umbral de varianza</li>
<li>Análisis de correlación</li>
<li>Selección por información mutua</li>
<li>Selección por importancia usando Random Forest</li>
</ul>

<p>El módulo tiene como objetivo reducir la dimensionalidad mientras preserva las características
más informativas para la tarea de clasificación.</p>
</div>

                        <input id="mod-feature_selection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-feature_selection-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="sd">Módulo de Selección de Características para Clasificación de Emociones en Música Turca.</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd">Este módulo proporciona un pipeline completo de selección de características que combina</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="sd">múltiples métodos para identificar las características más relevantes para la clasificación</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">de emociones en música turca. Los métodos incluyen:</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">- Filtrado por umbral de varianza</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">- Análisis de correlación</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">- Selección por información mutua</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">- Selección por importancia usando Random Forest</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">El módulo tiene como objetivo reducir la dimensionalidad mientras preserva las características</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="sd">más informativas para la tarea de clasificación.</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">VarianceThreshold</span><span class="p">,</span> <span class="n">mutual_info_classif</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="k">class</span> <span class="nc">FeatureSelector</span><span class="p">:</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    Clase para realizar selección de características usando múltiples métodos.</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">    Esta clase implementa un pipeline completo de selección de características que</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="sd">    combina varios métodos para seleccionar las características más relevantes</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    para la clasificación.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    Attributes:</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">        data_dir (str): Directorio que contiene los archivos de datos.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="sd">        processed_data_path (str): Ruta al archivo de características acústicas procesadas.</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="sd">        feature_selected_data_path (str): Ruta donde se guardarán las características seleccionadas.</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a><span class="sd">        df (pd.DataFrame): DataFrame que contiene el conjunto de datos completo.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="sd">        X (pd.DataFrame): Matriz de características.</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="sd">        y (pd.Series): Variable objetivo.</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="sd">        le (LabelEncoder): Codificador de etiquetas para la variable objetivo.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        y_encoded (np.array): Variable objetivo codificada.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">):</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        Inicializa el FeatureSelector con el directorio de datos.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">        Args:</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">            data_dir (str): Ruta al directorio que contiene los archivos de datos.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">processed_data_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/processed/Acoustic_Features_Processed.csv&quot;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/processed/feature_selected_data.csv&quot;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processed_data_path</span><span class="p">)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>    <span class="k">def</span> <span class="nf">variance_threshold_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        Selecciona características basadas en su varianza.</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        Elimina las características con varianza por debajo del umbral especificado.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        Args:</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">            threshold (float, optional): Umbral de varianza para la selección de características.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">                Por defecto es 0.01.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        Returns:</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">            list: Lista de nombres de características que superan el umbral de varianza.</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="n">selector</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="n">selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">selector</span><span class="o">.</span><span class="n">get_support</span><span class="p">()]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>    <span class="k">def</span> <span class="nf">correlation_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">        Elimina características altamente correlacionadas.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">        Identifica y elimina características que tienen un coeficiente de correlación</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        mayor que el umbral especificado.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        Args:</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">            threshold (float, optional): Umbral de correlación. Por defecto es 0.8.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        Returns:</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a><span class="sd">            list: Lista de características después de eliminar las altamente correlacionadas.</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>        <span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>        <span class="n">upper</span> <span class="o">=</span> <span class="n">corr_matrix</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>        <span class="n">to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">upper</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)]</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">to_drop</span><span class="p">]</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>    <span class="k">def</span> <span class="nf">mutual_information_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        Selecciona características basadas en información mutua con la variable objetivo.</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        Args:</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">            n_features (int, optional): Número de características principales a seleccionar. </span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">                Por defecto es 20.</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        Returns:</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">            list: Lista de características principales basadas en puntuaciones de información mutua.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mi_scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>        <span class="k">return</span> <span class="n">mi_scores</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>    <span class="k">def</span> <span class="nf">random_forest_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a><span class="sd">        Selecciona características basadas en la importancia determinada por Random Forest.</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a><span class="sd">        Args:</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a><span class="sd">            n_features (int, optional): Número de características principales a seleccionar. </span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a><span class="sd">                Por defecto es 20.</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a><span class="sd">        Returns:</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a><span class="sd">            list: Lista de características principales basadas en la importancia de Random Forest.</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>        <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">importances</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>        <span class="k">return</span> <span class="n">importances</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>    <span class="k">def</span> <span class="nf">plot_feature_importances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">importances</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">        Genera una gráfica de barras para visualizar la importancia de las características.</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">        Args:</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">            importances (pd.Series): Series con las puntuaciones de importancia.</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a><span class="sd">            title (str): Título para la gráfica.</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>        <span class="n">importances</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Features&#39;</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Importance&#39;</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>    <span class="k">def</span> <span class="nf">select_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">        Ejecuta el pipeline completo de selección de características.</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a><span class="sd">        Este método combina múltiples técnicas de selección:</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a><span class="sd">        1. Filtrado por umbral de varianza</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="sd">        2. Análisis de correlación</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="sd">        3. Selección por información mutua</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="sd">        4. Selección por importancia de Random Forest</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">        Returns:</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">            list: Lista final de nombres de características seleccionadas.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        Example:</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">            &gt;&gt;&gt; selector = FeatureSelector(&quot;data_directory&quot;)</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">            &gt;&gt;&gt; selected_features = selector.select_features()</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Se seleccionaron {len(selected_features)} características&quot;)</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original number of features:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>        <span class="c1"># 1. Variance Threshold</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>        <span class="n">var_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_threshold_selection</span><span class="p">()</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Features after variance threshold:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_selected</span><span class="p">))</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>        <span class="c1"># 2. Correlation Analysis</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>        <span class="n">corr_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_analysis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">var_selected</span><span class="p">])</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Features after correlation analysis:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_selected</span><span class="p">))</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>        <span class="c1"># 3. Mutual Information</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>        <span class="n">mi_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutual_information_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">])</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 20 features by mutual information:&quot;</span><span class="p">,</span> <span class="n">mi_selected</span><span class="p">)</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>        <span class="c1"># Plot mutual information scores</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature_importances</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="s1">&#39;Mutual Information Scores&#39;</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>        <span class="c1"># 4. Random Forest Feature Importance</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="n">rf_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_forest_importance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">])</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 20 features by random forest importance:&quot;</span><span class="p">,</span> <span class="n">rf_selected</span><span class="p">)</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>        <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature_importances</span><span class="p">(</span><span class="n">importances</span><span class="p">,</span> <span class="s1">&#39;Random Forest Feature Importance&#39;</span><span class="p">)</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>        <span class="n">combined_features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mi_selected</span> <span class="o">+</span> <span class="n">rf_selected</span><span class="p">))</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of features after combining MI and RF:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">combined_features</span><span class="p">))</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>        <span class="k">return</span> <span class="n">combined_features</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>    <span class="k">def</span> <span class="nf">save_selected_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_features</span><span class="p">):</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a><span class="sd">        Guarda las características seleccionadas en un archivo CSV.</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a><span class="sd">        Args:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a><span class="sd">            selected_features (list): Lista de nombres de características a guardar.</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="n">final_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">selected_features</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]]</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>        <span class="n">final_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature selection completed. Selected features saved to &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final selected features:&quot;</span><span class="p">)</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">selected_features</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="FeatureSelector">
                            <input id="FeatureSelector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FeatureSelector</span>:

                <label class="view-source-button" for="FeatureSelector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector-25"><a href="#FeatureSelector-25"><span class="linenos"> 25</span></a><span class="k">class</span> <span class="nc">FeatureSelector</span><span class="p">:</span>
</span><span id="FeatureSelector-26"><a href="#FeatureSelector-26"><span class="linenos"> 26</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-27"><a href="#FeatureSelector-27"><span class="linenos"> 27</span></a><span class="sd">    Clase para realizar selección de características usando múltiples métodos.</span>
</span><span id="FeatureSelector-28"><a href="#FeatureSelector-28"><span class="linenos"> 28</span></a>
</span><span id="FeatureSelector-29"><a href="#FeatureSelector-29"><span class="linenos"> 29</span></a><span class="sd">    Esta clase implementa un pipeline completo de selección de características que</span>
</span><span id="FeatureSelector-30"><a href="#FeatureSelector-30"><span class="linenos"> 30</span></a><span class="sd">    combina varios métodos para seleccionar las características más relevantes</span>
</span><span id="FeatureSelector-31"><a href="#FeatureSelector-31"><span class="linenos"> 31</span></a><span class="sd">    para la clasificación.</span>
</span><span id="FeatureSelector-32"><a href="#FeatureSelector-32"><span class="linenos"> 32</span></a>
</span><span id="FeatureSelector-33"><a href="#FeatureSelector-33"><span class="linenos"> 33</span></a><span class="sd">    Attributes:</span>
</span><span id="FeatureSelector-34"><a href="#FeatureSelector-34"><span class="linenos"> 34</span></a><span class="sd">        data_dir (str): Directorio que contiene los archivos de datos.</span>
</span><span id="FeatureSelector-35"><a href="#FeatureSelector-35"><span class="linenos"> 35</span></a><span class="sd">        processed_data_path (str): Ruta al archivo de características acústicas procesadas.</span>
</span><span id="FeatureSelector-36"><a href="#FeatureSelector-36"><span class="linenos"> 36</span></a><span class="sd">        feature_selected_data_path (str): Ruta donde se guardarán las características seleccionadas.</span>
</span><span id="FeatureSelector-37"><a href="#FeatureSelector-37"><span class="linenos"> 37</span></a><span class="sd">        df (pd.DataFrame): DataFrame que contiene el conjunto de datos completo.</span>
</span><span id="FeatureSelector-38"><a href="#FeatureSelector-38"><span class="linenos"> 38</span></a><span class="sd">        X (pd.DataFrame): Matriz de características.</span>
</span><span id="FeatureSelector-39"><a href="#FeatureSelector-39"><span class="linenos"> 39</span></a><span class="sd">        y (pd.Series): Variable objetivo.</span>
</span><span id="FeatureSelector-40"><a href="#FeatureSelector-40"><span class="linenos"> 40</span></a><span class="sd">        le (LabelEncoder): Codificador de etiquetas para la variable objetivo.</span>
</span><span id="FeatureSelector-41"><a href="#FeatureSelector-41"><span class="linenos"> 41</span></a><span class="sd">        y_encoded (np.array): Variable objetivo codificada.</span>
</span><span id="FeatureSelector-42"><a href="#FeatureSelector-42"><span class="linenos"> 42</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-43"><a href="#FeatureSelector-43"><span class="linenos"> 43</span></a>
</span><span id="FeatureSelector-44"><a href="#FeatureSelector-44"><span class="linenos"> 44</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">):</span>
</span><span id="FeatureSelector-45"><a href="#FeatureSelector-45"><span class="linenos"> 45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-46"><a href="#FeatureSelector-46"><span class="linenos"> 46</span></a><span class="sd">        Inicializa el FeatureSelector con el directorio de datos.</span>
</span><span id="FeatureSelector-47"><a href="#FeatureSelector-47"><span class="linenos"> 47</span></a>
</span><span id="FeatureSelector-48"><a href="#FeatureSelector-48"><span class="linenos"> 48</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector-49"><a href="#FeatureSelector-49"><span class="linenos"> 49</span></a><span class="sd">            data_dir (str): Ruta al directorio que contiene los archivos de datos.</span>
</span><span id="FeatureSelector-50"><a href="#FeatureSelector-50"><span class="linenos"> 50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-51"><a href="#FeatureSelector-51"><span class="linenos"> 51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
</span><span id="FeatureSelector-52"><a href="#FeatureSelector-52"><span class="linenos"> 52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">processed_data_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/processed/Acoustic_Features_Processed.csv&quot;</span>
</span><span id="FeatureSelector-53"><a href="#FeatureSelector-53"><span class="linenos"> 53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/processed/feature_selected_data.csv&quot;</span>
</span><span id="FeatureSelector-54"><a href="#FeatureSelector-54"><span class="linenos"> 54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processed_data_path</span><span class="p">)</span>
</span><span id="FeatureSelector-55"><a href="#FeatureSelector-55"><span class="linenos"> 55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="FeatureSelector-56"><a href="#FeatureSelector-56"><span class="linenos"> 56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span>
</span><span id="FeatureSelector-57"><a href="#FeatureSelector-57"><span class="linenos"> 57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="FeatureSelector-58"><a href="#FeatureSelector-58"><span class="linenos"> 58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="FeatureSelector-59"><a href="#FeatureSelector-59"><span class="linenos"> 59</span></a>
</span><span id="FeatureSelector-60"><a href="#FeatureSelector-60"><span class="linenos"> 60</span></a>    <span class="k">def</span> <span class="nf">variance_threshold_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
</span><span id="FeatureSelector-61"><a href="#FeatureSelector-61"><span class="linenos"> 61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-62"><a href="#FeatureSelector-62"><span class="linenos"> 62</span></a><span class="sd">        Selecciona características basadas en su varianza.</span>
</span><span id="FeatureSelector-63"><a href="#FeatureSelector-63"><span class="linenos"> 63</span></a>
</span><span id="FeatureSelector-64"><a href="#FeatureSelector-64"><span class="linenos"> 64</span></a><span class="sd">        Elimina las características con varianza por debajo del umbral especificado.</span>
</span><span id="FeatureSelector-65"><a href="#FeatureSelector-65"><span class="linenos"> 65</span></a>
</span><span id="FeatureSelector-66"><a href="#FeatureSelector-66"><span class="linenos"> 66</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector-67"><a href="#FeatureSelector-67"><span class="linenos"> 67</span></a><span class="sd">            threshold (float, optional): Umbral de varianza para la selección de características.</span>
</span><span id="FeatureSelector-68"><a href="#FeatureSelector-68"><span class="linenos"> 68</span></a><span class="sd">                Por defecto es 0.01.</span>
</span><span id="FeatureSelector-69"><a href="#FeatureSelector-69"><span class="linenos"> 69</span></a>
</span><span id="FeatureSelector-70"><a href="#FeatureSelector-70"><span class="linenos"> 70</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector-71"><a href="#FeatureSelector-71"><span class="linenos"> 71</span></a><span class="sd">            list: Lista de nombres de características que superan el umbral de varianza.</span>
</span><span id="FeatureSelector-72"><a href="#FeatureSelector-72"><span class="linenos"> 72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-73"><a href="#FeatureSelector-73"><span class="linenos"> 73</span></a>        <span class="n">selector</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="FeatureSelector-74"><a href="#FeatureSelector-74"><span class="linenos"> 74</span></a>        <span class="n">selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
</span><span id="FeatureSelector-75"><a href="#FeatureSelector-75"><span class="linenos"> 75</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">selector</span><span class="o">.</span><span class="n">get_support</span><span class="p">()]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="FeatureSelector-76"><a href="#FeatureSelector-76"><span class="linenos"> 76</span></a>
</span><span id="FeatureSelector-77"><a href="#FeatureSelector-77"><span class="linenos"> 77</span></a>    <span class="k">def</span> <span class="nf">correlation_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span>
</span><span id="FeatureSelector-78"><a href="#FeatureSelector-78"><span class="linenos"> 78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-79"><a href="#FeatureSelector-79"><span class="linenos"> 79</span></a><span class="sd">        Elimina características altamente correlacionadas.</span>
</span><span id="FeatureSelector-80"><a href="#FeatureSelector-80"><span class="linenos"> 80</span></a>
</span><span id="FeatureSelector-81"><a href="#FeatureSelector-81"><span class="linenos"> 81</span></a><span class="sd">        Identifica y elimina características que tienen un coeficiente de correlación</span>
</span><span id="FeatureSelector-82"><a href="#FeatureSelector-82"><span class="linenos"> 82</span></a><span class="sd">        mayor que el umbral especificado.</span>
</span><span id="FeatureSelector-83"><a href="#FeatureSelector-83"><span class="linenos"> 83</span></a>
</span><span id="FeatureSelector-84"><a href="#FeatureSelector-84"><span class="linenos"> 84</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector-85"><a href="#FeatureSelector-85"><span class="linenos"> 85</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="FeatureSelector-86"><a href="#FeatureSelector-86"><span class="linenos"> 86</span></a><span class="sd">            threshold (float, optional): Umbral de correlación. Por defecto es 0.8.</span>
</span><span id="FeatureSelector-87"><a href="#FeatureSelector-87"><span class="linenos"> 87</span></a>
</span><span id="FeatureSelector-88"><a href="#FeatureSelector-88"><span class="linenos"> 88</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector-89"><a href="#FeatureSelector-89"><span class="linenos"> 89</span></a><span class="sd">            list: Lista de características después de eliminar las altamente correlacionadas.</span>
</span><span id="FeatureSelector-90"><a href="#FeatureSelector-90"><span class="linenos"> 90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-91"><a href="#FeatureSelector-91"><span class="linenos"> 91</span></a>        <span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</span><span id="FeatureSelector-92"><a href="#FeatureSelector-92"><span class="linenos"> 92</span></a>        <span class="n">upper</span> <span class="o">=</span> <span class="n">corr_matrix</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
</span><span id="FeatureSelector-93"><a href="#FeatureSelector-93"><span class="linenos"> 93</span></a>        <span class="n">to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">upper</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)]</span>
</span><span id="FeatureSelector-94"><a href="#FeatureSelector-94"><span class="linenos"> 94</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">to_drop</span><span class="p">]</span>
</span><span id="FeatureSelector-95"><a href="#FeatureSelector-95"><span class="linenos"> 95</span></a>
</span><span id="FeatureSelector-96"><a href="#FeatureSelector-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">mutual_information_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
</span><span id="FeatureSelector-97"><a href="#FeatureSelector-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-98"><a href="#FeatureSelector-98"><span class="linenos"> 98</span></a><span class="sd">        Selecciona características basadas en información mutua con la variable objetivo.</span>
</span><span id="FeatureSelector-99"><a href="#FeatureSelector-99"><span class="linenos"> 99</span></a>
</span><span id="FeatureSelector-100"><a href="#FeatureSelector-100"><span class="linenos">100</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector-101"><a href="#FeatureSelector-101"><span class="linenos">101</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="FeatureSelector-102"><a href="#FeatureSelector-102"><span class="linenos">102</span></a><span class="sd">            n_features (int, optional): Número de características principales a seleccionar. </span>
</span><span id="FeatureSelector-103"><a href="#FeatureSelector-103"><span class="linenos">103</span></a><span class="sd">                Por defecto es 20.</span>
</span><span id="FeatureSelector-104"><a href="#FeatureSelector-104"><span class="linenos">104</span></a>
</span><span id="FeatureSelector-105"><a href="#FeatureSelector-105"><span class="linenos">105</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector-106"><a href="#FeatureSelector-106"><span class="linenos">106</span></a><span class="sd">            list: Lista de características principales basadas en puntuaciones de información mutua.</span>
</span><span id="FeatureSelector-107"><a href="#FeatureSelector-107"><span class="linenos">107</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-108"><a href="#FeatureSelector-108"><span class="linenos">108</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="FeatureSelector-109"><a href="#FeatureSelector-109"><span class="linenos">109</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="FeatureSelector-110"><a href="#FeatureSelector-110"><span class="linenos">110</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mi_scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector-111"><a href="#FeatureSelector-111"><span class="linenos">111</span></a>        <span class="k">return</span> <span class="n">mi_scores</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="FeatureSelector-112"><a href="#FeatureSelector-112"><span class="linenos">112</span></a>
</span><span id="FeatureSelector-113"><a href="#FeatureSelector-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">random_forest_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
</span><span id="FeatureSelector-114"><a href="#FeatureSelector-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-115"><a href="#FeatureSelector-115"><span class="linenos">115</span></a><span class="sd">        Selecciona características basadas en la importancia determinada por Random Forest.</span>
</span><span id="FeatureSelector-116"><a href="#FeatureSelector-116"><span class="linenos">116</span></a>
</span><span id="FeatureSelector-117"><a href="#FeatureSelector-117"><span class="linenos">117</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector-118"><a href="#FeatureSelector-118"><span class="linenos">118</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="FeatureSelector-119"><a href="#FeatureSelector-119"><span class="linenos">119</span></a><span class="sd">            n_features (int, optional): Número de características principales a seleccionar. </span>
</span><span id="FeatureSelector-120"><a href="#FeatureSelector-120"><span class="linenos">120</span></a><span class="sd">                Por defecto es 20.</span>
</span><span id="FeatureSelector-121"><a href="#FeatureSelector-121"><span class="linenos">121</span></a>
</span><span id="FeatureSelector-122"><a href="#FeatureSelector-122"><span class="linenos">122</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector-123"><a href="#FeatureSelector-123"><span class="linenos">123</span></a><span class="sd">            list: Lista de características principales basadas en la importancia de Random Forest.</span>
</span><span id="FeatureSelector-124"><a href="#FeatureSelector-124"><span class="linenos">124</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-125"><a href="#FeatureSelector-125"><span class="linenos">125</span></a>        <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="FeatureSelector-126"><a href="#FeatureSelector-126"><span class="linenos">126</span></a>        <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="FeatureSelector-127"><a href="#FeatureSelector-127"><span class="linenos">127</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="FeatureSelector-128"><a href="#FeatureSelector-128"><span class="linenos">128</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">importances</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector-129"><a href="#FeatureSelector-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="n">importances</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span><span id="FeatureSelector-130"><a href="#FeatureSelector-130"><span class="linenos">130</span></a>
</span><span id="FeatureSelector-131"><a href="#FeatureSelector-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">plot_feature_importances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">importances</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
</span><span id="FeatureSelector-132"><a href="#FeatureSelector-132"><span class="linenos">132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-133"><a href="#FeatureSelector-133"><span class="linenos">133</span></a><span class="sd">        Genera una gráfica de barras para visualizar la importancia de las características.</span>
</span><span id="FeatureSelector-134"><a href="#FeatureSelector-134"><span class="linenos">134</span></a>
</span><span id="FeatureSelector-135"><a href="#FeatureSelector-135"><span class="linenos">135</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector-136"><a href="#FeatureSelector-136"><span class="linenos">136</span></a><span class="sd">            importances (pd.Series): Series con las puntuaciones de importancia.</span>
</span><span id="FeatureSelector-137"><a href="#FeatureSelector-137"><span class="linenos">137</span></a><span class="sd">            title (str): Título para la gráfica.</span>
</span><span id="FeatureSelector-138"><a href="#FeatureSelector-138"><span class="linenos">138</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-139"><a href="#FeatureSelector-139"><span class="linenos">139</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="FeatureSelector-140"><a href="#FeatureSelector-140"><span class="linenos">140</span></a>        <span class="n">importances</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector-141"><a href="#FeatureSelector-141"><span class="linenos">141</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="FeatureSelector-142"><a href="#FeatureSelector-142"><span class="linenos">142</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Features&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector-143"><a href="#FeatureSelector-143"><span class="linenos">143</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Importance&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector-144"><a href="#FeatureSelector-144"><span class="linenos">144</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="FeatureSelector-145"><a href="#FeatureSelector-145"><span class="linenos">145</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span><span id="FeatureSelector-146"><a href="#FeatureSelector-146"><span class="linenos">146</span></a>
</span><span id="FeatureSelector-147"><a href="#FeatureSelector-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">select_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureSelector-148"><a href="#FeatureSelector-148"><span class="linenos">148</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-149"><a href="#FeatureSelector-149"><span class="linenos">149</span></a><span class="sd">        Ejecuta el pipeline completo de selección de características.</span>
</span><span id="FeatureSelector-150"><a href="#FeatureSelector-150"><span class="linenos">150</span></a>
</span><span id="FeatureSelector-151"><a href="#FeatureSelector-151"><span class="linenos">151</span></a><span class="sd">        Este método combina múltiples técnicas de selección:</span>
</span><span id="FeatureSelector-152"><a href="#FeatureSelector-152"><span class="linenos">152</span></a><span class="sd">        1. Filtrado por umbral de varianza</span>
</span><span id="FeatureSelector-153"><a href="#FeatureSelector-153"><span class="linenos">153</span></a><span class="sd">        2. Análisis de correlación</span>
</span><span id="FeatureSelector-154"><a href="#FeatureSelector-154"><span class="linenos">154</span></a><span class="sd">        3. Selección por información mutua</span>
</span><span id="FeatureSelector-155"><a href="#FeatureSelector-155"><span class="linenos">155</span></a><span class="sd">        4. Selección por importancia de Random Forest</span>
</span><span id="FeatureSelector-156"><a href="#FeatureSelector-156"><span class="linenos">156</span></a>
</span><span id="FeatureSelector-157"><a href="#FeatureSelector-157"><span class="linenos">157</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector-158"><a href="#FeatureSelector-158"><span class="linenos">158</span></a><span class="sd">            list: Lista final de nombres de características seleccionadas.</span>
</span><span id="FeatureSelector-159"><a href="#FeatureSelector-159"><span class="linenos">159</span></a>
</span><span id="FeatureSelector-160"><a href="#FeatureSelector-160"><span class="linenos">160</span></a><span class="sd">        Example:</span>
</span><span id="FeatureSelector-161"><a href="#FeatureSelector-161"><span class="linenos">161</span></a><span class="sd">            &gt;&gt;&gt; selector = FeatureSelector(&quot;data_directory&quot;)</span>
</span><span id="FeatureSelector-162"><a href="#FeatureSelector-162"><span class="linenos">162</span></a><span class="sd">            &gt;&gt;&gt; selected_features = selector.select_features()</span>
</span><span id="FeatureSelector-163"><a href="#FeatureSelector-163"><span class="linenos">163</span></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Se seleccionaron {len(selected_features)} características&quot;)</span>
</span><span id="FeatureSelector-164"><a href="#FeatureSelector-164"><span class="linenos">164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-165"><a href="#FeatureSelector-165"><span class="linenos">165</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original number of features:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FeatureSelector-166"><a href="#FeatureSelector-166"><span class="linenos">166</span></a>
</span><span id="FeatureSelector-167"><a href="#FeatureSelector-167"><span class="linenos">167</span></a>        <span class="c1"># 1. Variance Threshold</span>
</span><span id="FeatureSelector-168"><a href="#FeatureSelector-168"><span class="linenos">168</span></a>        <span class="n">var_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_threshold_selection</span><span class="p">()</span>
</span><span id="FeatureSelector-169"><a href="#FeatureSelector-169"><span class="linenos">169</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Features after variance threshold:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_selected</span><span class="p">))</span>
</span><span id="FeatureSelector-170"><a href="#FeatureSelector-170"><span class="linenos">170</span></a>
</span><span id="FeatureSelector-171"><a href="#FeatureSelector-171"><span class="linenos">171</span></a>        <span class="c1"># 2. Correlation Analysis</span>
</span><span id="FeatureSelector-172"><a href="#FeatureSelector-172"><span class="linenos">172</span></a>        <span class="n">corr_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_analysis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">var_selected</span><span class="p">])</span>
</span><span id="FeatureSelector-173"><a href="#FeatureSelector-173"><span class="linenos">173</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Features after correlation analysis:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_selected</span><span class="p">))</span>
</span><span id="FeatureSelector-174"><a href="#FeatureSelector-174"><span class="linenos">174</span></a>
</span><span id="FeatureSelector-175"><a href="#FeatureSelector-175"><span class="linenos">175</span></a>        <span class="c1"># 3. Mutual Information</span>
</span><span id="FeatureSelector-176"><a href="#FeatureSelector-176"><span class="linenos">176</span></a>        <span class="n">mi_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutual_information_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">])</span>
</span><span id="FeatureSelector-177"><a href="#FeatureSelector-177"><span class="linenos">177</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 20 features by mutual information:&quot;</span><span class="p">,</span> <span class="n">mi_selected</span><span class="p">)</span>
</span><span id="FeatureSelector-178"><a href="#FeatureSelector-178"><span class="linenos">178</span></a>
</span><span id="FeatureSelector-179"><a href="#FeatureSelector-179"><span class="linenos">179</span></a>        <span class="c1"># Plot mutual information scores</span>
</span><span id="FeatureSelector-180"><a href="#FeatureSelector-180"><span class="linenos">180</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="FeatureSelector-181"><a href="#FeatureSelector-181"><span class="linenos">181</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector-182"><a href="#FeatureSelector-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature_importances</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="s1">&#39;Mutual Information Scores&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector-183"><a href="#FeatureSelector-183"><span class="linenos">183</span></a>
</span><span id="FeatureSelector-184"><a href="#FeatureSelector-184"><span class="linenos">184</span></a>        <span class="c1"># 4. Random Forest Feature Importance</span>
</span><span id="FeatureSelector-185"><a href="#FeatureSelector-185"><span class="linenos">185</span></a>        <span class="n">rf_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_forest_importance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">])</span>
</span><span id="FeatureSelector-186"><a href="#FeatureSelector-186"><span class="linenos">186</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 20 features by random forest importance:&quot;</span><span class="p">,</span> <span class="n">rf_selected</span><span class="p">)</span>
</span><span id="FeatureSelector-187"><a href="#FeatureSelector-187"><span class="linenos">187</span></a>
</span><span id="FeatureSelector-188"><a href="#FeatureSelector-188"><span class="linenos">188</span></a>        <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="FeatureSelector-189"><a href="#FeatureSelector-189"><span class="linenos">189</span></a>        <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="FeatureSelector-190"><a href="#FeatureSelector-190"><span class="linenos">190</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector-191"><a href="#FeatureSelector-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature_importances</span><span class="p">(</span><span class="n">importances</span><span class="p">,</span> <span class="s1">&#39;Random Forest Feature Importance&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector-192"><a href="#FeatureSelector-192"><span class="linenos">192</span></a>
</span><span id="FeatureSelector-193"><a href="#FeatureSelector-193"><span class="linenos">193</span></a>        <span class="n">combined_features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mi_selected</span> <span class="o">+</span> <span class="n">rf_selected</span><span class="p">))</span>
</span><span id="FeatureSelector-194"><a href="#FeatureSelector-194"><span class="linenos">194</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of features after combining MI and RF:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">combined_features</span><span class="p">))</span>
</span><span id="FeatureSelector-195"><a href="#FeatureSelector-195"><span class="linenos">195</span></a>
</span><span id="FeatureSelector-196"><a href="#FeatureSelector-196"><span class="linenos">196</span></a>        <span class="k">return</span> <span class="n">combined_features</span>
</span><span id="FeatureSelector-197"><a href="#FeatureSelector-197"><span class="linenos">197</span></a>
</span><span id="FeatureSelector-198"><a href="#FeatureSelector-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="nf">save_selected_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_features</span><span class="p">):</span>
</span><span id="FeatureSelector-199"><a href="#FeatureSelector-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector-200"><a href="#FeatureSelector-200"><span class="linenos">200</span></a><span class="sd">        Guarda las características seleccionadas en un archivo CSV.</span>
</span><span id="FeatureSelector-201"><a href="#FeatureSelector-201"><span class="linenos">201</span></a>
</span><span id="FeatureSelector-202"><a href="#FeatureSelector-202"><span class="linenos">202</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector-203"><a href="#FeatureSelector-203"><span class="linenos">203</span></a><span class="sd">            selected_features (list): Lista de nombres de características a guardar.</span>
</span><span id="FeatureSelector-204"><a href="#FeatureSelector-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector-205"><a href="#FeatureSelector-205"><span class="linenos">205</span></a>        <span class="n">final_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">selected_features</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]]</span>
</span><span id="FeatureSelector-206"><a href="#FeatureSelector-206"><span class="linenos">206</span></a>        <span class="n">final_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector-207"><a href="#FeatureSelector-207"><span class="linenos">207</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature selection completed. Selected features saved to &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="FeatureSelector-208"><a href="#FeatureSelector-208"><span class="linenos">208</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final selected features:&quot;</span><span class="p">)</span>
</span><span id="FeatureSelector-209"><a href="#FeatureSelector-209"><span class="linenos">209</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">selected_features</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Clase para realizar selección de características usando múltiples métodos.</p>

<p>Esta clase implementa un pipeline completo de selección de características que
combina varios métodos para seleccionar las características más relevantes
para la clasificación.</p>

<h6 id="attributes">Attributes:</h6>

<ul>
<li><strong>data_dir (str):</strong>  Directorio que contiene los archivos de datos.</li>
<li><strong>processed_data_path (str):</strong>  Ruta al archivo de características acústicas procesadas.</li>
<li><strong>feature_selected_data_path (str):</strong>  Ruta donde se guardarán las características seleccionadas.</li>
<li><strong>df (pd.DataFrame):</strong>  DataFrame que contiene el conjunto de datos completo.</li>
<li><strong>X (pd.DataFrame):</strong>  Matriz de características.</li>
<li><strong>y (pd.Series):</strong>  Variable objetivo.</li>
<li><strong>le (LabelEncoder):</strong>  Codificador de etiquetas para la variable objetivo.</li>
<li><strong>y_encoded (np.array):</strong>  Variable objetivo codificada.</li>
</ul>
</div>


                            <div id="FeatureSelector.__init__" class="classattr">
                                        <input id="FeatureSelector.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">FeatureSelector</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">data_dir</span></span>)</span>

                <label class="view-source-button" for="FeatureSelector.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector.__init__-44"><a href="#FeatureSelector.__init__-44"><span class="linenos">44</span></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">):</span>
</span><span id="FeatureSelector.__init__-45"><a href="#FeatureSelector.__init__-45"><span class="linenos">45</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector.__init__-46"><a href="#FeatureSelector.__init__-46"><span class="linenos">46</span></a><span class="sd">        Inicializa el FeatureSelector con el directorio de datos.</span>
</span><span id="FeatureSelector.__init__-47"><a href="#FeatureSelector.__init__-47"><span class="linenos">47</span></a>
</span><span id="FeatureSelector.__init__-48"><a href="#FeatureSelector.__init__-48"><span class="linenos">48</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector.__init__-49"><a href="#FeatureSelector.__init__-49"><span class="linenos">49</span></a><span class="sd">            data_dir (str): Ruta al directorio que contiene los archivos de datos.</span>
</span><span id="FeatureSelector.__init__-50"><a href="#FeatureSelector.__init__-50"><span class="linenos">50</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector.__init__-51"><a href="#FeatureSelector.__init__-51"><span class="linenos">51</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">data_dir</span> <span class="o">=</span> <span class="n">data_dir</span>
</span><span id="FeatureSelector.__init__-52"><a href="#FeatureSelector.__init__-52"><span class="linenos">52</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">processed_data_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/processed/Acoustic_Features_Processed.csv&quot;</span>
</span><span id="FeatureSelector.__init__-53"><a href="#FeatureSelector.__init__-53"><span class="linenos">53</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data_dir</span><span class="si">}</span><span class="s2">/processed/feature_selected_data.csv&quot;</span>
</span><span id="FeatureSelector.__init__-54"><a href="#FeatureSelector.__init__-54"><span class="linenos">54</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processed_data_path</span><span class="p">)</span>
</span><span id="FeatureSelector.__init__-55"><a href="#FeatureSelector.__init__-55"><span class="linenos">55</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Class&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="FeatureSelector.__init__-56"><a href="#FeatureSelector.__init__-56"><span class="linenos">56</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span>
</span><span id="FeatureSelector.__init__-57"><a href="#FeatureSelector.__init__-57"><span class="linenos">57</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">le</span> <span class="o">=</span> <span class="n">LabelEncoder</span><span class="p">()</span>
</span><span id="FeatureSelector.__init__-58"><a href="#FeatureSelector.__init__-58"><span class="linenos">58</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Inicializa el FeatureSelector con el directorio de datos.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>data_dir (str):</strong>  Ruta al directorio que contiene los archivos de datos.</li>
</ul>
</div>


                            </div>
                            <div id="FeatureSelector.data_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">data_dir</span>

        
    </div>
    <a class="headerlink" href="#FeatureSelector.data_dir"></a>
    
    

                            </div>
                            <div id="FeatureSelector.processed_data_path" class="classattr">
                                <div class="attr variable">
            <span class="name">processed_data_path</span>

        
    </div>
    <a class="headerlink" href="#FeatureSelector.processed_data_path"></a>
    
    

                            </div>
                            <div id="FeatureSelector.feature_selected_data_path" class="classattr">
                                <div class="attr variable">
            <span class="name">feature_selected_data_path</span>

        
    </div>
    <a class="headerlink" href="#FeatureSelector.feature_selected_data_path"></a>
    
    

                            </div>
                            <div id="FeatureSelector.df" class="classattr">
                                <div class="attr variable">
            <span class="name">df</span>

        
    </div>
    <a class="headerlink" href="#FeatureSelector.df"></a>
    
    

                            </div>
                            <div id="FeatureSelector.X" class="classattr">
                                <div class="attr variable">
            <span class="name">X</span>

        
    </div>
    <a class="headerlink" href="#FeatureSelector.X"></a>
    
    

                            </div>
                            <div id="FeatureSelector.y" class="classattr">
                                <div class="attr variable">
            <span class="name">y</span>

        
    </div>
    <a class="headerlink" href="#FeatureSelector.y"></a>
    
    

                            </div>
                            <div id="FeatureSelector.le" class="classattr">
                                <div class="attr variable">
            <span class="name">le</span>

        
    </div>
    <a class="headerlink" href="#FeatureSelector.le"></a>
    
    

                            </div>
                            <div id="FeatureSelector.y_encoded" class="classattr">
                                <div class="attr variable">
            <span class="name">y_encoded</span>

        
    </div>
    <a class="headerlink" href="#FeatureSelector.y_encoded"></a>
    
    

                            </div>
                            <div id="FeatureSelector.variance_threshold_selection" class="classattr">
                                        <input id="FeatureSelector.variance_threshold_selection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">variance_threshold_selection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">threshold</span><span class="o">=</span><span class="mf">0.01</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureSelector.variance_threshold_selection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector.variance_threshold_selection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector.variance_threshold_selection-60"><a href="#FeatureSelector.variance_threshold_selection-60"><span class="linenos">60</span></a>    <span class="k">def</span> <span class="nf">variance_threshold_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
</span><span id="FeatureSelector.variance_threshold_selection-61"><a href="#FeatureSelector.variance_threshold_selection-61"><span class="linenos">61</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector.variance_threshold_selection-62"><a href="#FeatureSelector.variance_threshold_selection-62"><span class="linenos">62</span></a><span class="sd">        Selecciona características basadas en su varianza.</span>
</span><span id="FeatureSelector.variance_threshold_selection-63"><a href="#FeatureSelector.variance_threshold_selection-63"><span class="linenos">63</span></a>
</span><span id="FeatureSelector.variance_threshold_selection-64"><a href="#FeatureSelector.variance_threshold_selection-64"><span class="linenos">64</span></a><span class="sd">        Elimina las características con varianza por debajo del umbral especificado.</span>
</span><span id="FeatureSelector.variance_threshold_selection-65"><a href="#FeatureSelector.variance_threshold_selection-65"><span class="linenos">65</span></a>
</span><span id="FeatureSelector.variance_threshold_selection-66"><a href="#FeatureSelector.variance_threshold_selection-66"><span class="linenos">66</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector.variance_threshold_selection-67"><a href="#FeatureSelector.variance_threshold_selection-67"><span class="linenos">67</span></a><span class="sd">            threshold (float, optional): Umbral de varianza para la selección de características.</span>
</span><span id="FeatureSelector.variance_threshold_selection-68"><a href="#FeatureSelector.variance_threshold_selection-68"><span class="linenos">68</span></a><span class="sd">                Por defecto es 0.01.</span>
</span><span id="FeatureSelector.variance_threshold_selection-69"><a href="#FeatureSelector.variance_threshold_selection-69"><span class="linenos">69</span></a>
</span><span id="FeatureSelector.variance_threshold_selection-70"><a href="#FeatureSelector.variance_threshold_selection-70"><span class="linenos">70</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector.variance_threshold_selection-71"><a href="#FeatureSelector.variance_threshold_selection-71"><span class="linenos">71</span></a><span class="sd">            list: Lista de nombres de características que superan el umbral de varianza.</span>
</span><span id="FeatureSelector.variance_threshold_selection-72"><a href="#FeatureSelector.variance_threshold_selection-72"><span class="linenos">72</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector.variance_threshold_selection-73"><a href="#FeatureSelector.variance_threshold_selection-73"><span class="linenos">73</span></a>        <span class="n">selector</span> <span class="o">=</span> <span class="n">VarianceThreshold</span><span class="p">(</span><span class="n">threshold</span><span class="p">)</span>
</span><span id="FeatureSelector.variance_threshold_selection-74"><a href="#FeatureSelector.variance_threshold_selection-74"><span class="linenos">74</span></a>        <span class="n">selector</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
</span><span id="FeatureSelector.variance_threshold_selection-75"><a href="#FeatureSelector.variance_threshold_selection-75"><span class="linenos">75</span></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">selector</span><span class="o">.</span><span class="n">get_support</span><span class="p">()]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Selecciona características basadas en su varianza.</p>

<p>Elimina las características con varianza por debajo del umbral especificado.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>threshold (float, optional):</strong>  Umbral de varianza para la selección de características.
Por defecto es 0.01.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: Lista de nombres de características que superan el umbral de varianza.</p>
</blockquote>
</div>


                            </div>
                            <div id="FeatureSelector.correlation_analysis" class="classattr">
                                        <input id="FeatureSelector.correlation_analysis-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">correlation_analysis</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureSelector.correlation_analysis-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector.correlation_analysis"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector.correlation_analysis-77"><a href="#FeatureSelector.correlation_analysis-77"><span class="linenos">77</span></a>    <span class="k">def</span> <span class="nf">correlation_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">):</span>
</span><span id="FeatureSelector.correlation_analysis-78"><a href="#FeatureSelector.correlation_analysis-78"><span class="linenos">78</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector.correlation_analysis-79"><a href="#FeatureSelector.correlation_analysis-79"><span class="linenos">79</span></a><span class="sd">        Elimina características altamente correlacionadas.</span>
</span><span id="FeatureSelector.correlation_analysis-80"><a href="#FeatureSelector.correlation_analysis-80"><span class="linenos">80</span></a>
</span><span id="FeatureSelector.correlation_analysis-81"><a href="#FeatureSelector.correlation_analysis-81"><span class="linenos">81</span></a><span class="sd">        Identifica y elimina características que tienen un coeficiente de correlación</span>
</span><span id="FeatureSelector.correlation_analysis-82"><a href="#FeatureSelector.correlation_analysis-82"><span class="linenos">82</span></a><span class="sd">        mayor que el umbral especificado.</span>
</span><span id="FeatureSelector.correlation_analysis-83"><a href="#FeatureSelector.correlation_analysis-83"><span class="linenos">83</span></a>
</span><span id="FeatureSelector.correlation_analysis-84"><a href="#FeatureSelector.correlation_analysis-84"><span class="linenos">84</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector.correlation_analysis-85"><a href="#FeatureSelector.correlation_analysis-85"><span class="linenos">85</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="FeatureSelector.correlation_analysis-86"><a href="#FeatureSelector.correlation_analysis-86"><span class="linenos">86</span></a><span class="sd">            threshold (float, optional): Umbral de correlación. Por defecto es 0.8.</span>
</span><span id="FeatureSelector.correlation_analysis-87"><a href="#FeatureSelector.correlation_analysis-87"><span class="linenos">87</span></a>
</span><span id="FeatureSelector.correlation_analysis-88"><a href="#FeatureSelector.correlation_analysis-88"><span class="linenos">88</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector.correlation_analysis-89"><a href="#FeatureSelector.correlation_analysis-89"><span class="linenos">89</span></a><span class="sd">            list: Lista de características después de eliminar las altamente correlacionadas.</span>
</span><span id="FeatureSelector.correlation_analysis-90"><a href="#FeatureSelector.correlation_analysis-90"><span class="linenos">90</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector.correlation_analysis-91"><a href="#FeatureSelector.correlation_analysis-91"><span class="linenos">91</span></a>        <span class="n">corr_matrix</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span>
</span><span id="FeatureSelector.correlation_analysis-92"><a href="#FeatureSelector.correlation_analysis-92"><span class="linenos">92</span></a>        <span class="n">upper</span> <span class="o">=</span> <span class="n">corr_matrix</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">triu</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">corr_matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">),</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">))</span>
</span><span id="FeatureSelector.correlation_analysis-93"><a href="#FeatureSelector.correlation_analysis-93"><span class="linenos">93</span></a>        <span class="n">to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">upper</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="nb">any</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)]</span>
</span><span id="FeatureSelector.correlation_analysis-94"><a href="#FeatureSelector.correlation_analysis-94"><span class="linenos">94</span></a>        <span class="k">return</span> <span class="p">[</span><span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">X</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="n">col</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">to_drop</span><span class="p">]</span>
</span></pre></div>


            <div class="docstring"><p>Elimina características altamente correlacionadas.</p>

<p>Identifica y elimina características que tienen un coeficiente de correlación
mayor que el umbral especificado.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>X (pd.DataFrame):</strong>  Matriz de características para analizar.</li>
<li><strong>threshold (float, optional):</strong>  Umbral de correlación. Por defecto es 0.8.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: Lista de características después de eliminar las altamente correlacionadas.</p>
</blockquote>
</div>


                            </div>
                            <div id="FeatureSelector.mutual_information_selection" class="classattr">
                                        <input id="FeatureSelector.mutual_information_selection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mutual_information_selection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">n_features</span><span class="o">=</span><span class="mi">20</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureSelector.mutual_information_selection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector.mutual_information_selection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector.mutual_information_selection-96"><a href="#FeatureSelector.mutual_information_selection-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">mutual_information_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
</span><span id="FeatureSelector.mutual_information_selection-97"><a href="#FeatureSelector.mutual_information_selection-97"><span class="linenos"> 97</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector.mutual_information_selection-98"><a href="#FeatureSelector.mutual_information_selection-98"><span class="linenos"> 98</span></a><span class="sd">        Selecciona características basadas en información mutua con la variable objetivo.</span>
</span><span id="FeatureSelector.mutual_information_selection-99"><a href="#FeatureSelector.mutual_information_selection-99"><span class="linenos"> 99</span></a>
</span><span id="FeatureSelector.mutual_information_selection-100"><a href="#FeatureSelector.mutual_information_selection-100"><span class="linenos">100</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector.mutual_information_selection-101"><a href="#FeatureSelector.mutual_information_selection-101"><span class="linenos">101</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="FeatureSelector.mutual_information_selection-102"><a href="#FeatureSelector.mutual_information_selection-102"><span class="linenos">102</span></a><span class="sd">            n_features (int, optional): Número de características principales a seleccionar. </span>
</span><span id="FeatureSelector.mutual_information_selection-103"><a href="#FeatureSelector.mutual_information_selection-103"><span class="linenos">103</span></a><span class="sd">                Por defecto es 20.</span>
</span><span id="FeatureSelector.mutual_information_selection-104"><a href="#FeatureSelector.mutual_information_selection-104"><span class="linenos">104</span></a>
</span><span id="FeatureSelector.mutual_information_selection-105"><a href="#FeatureSelector.mutual_information_selection-105"><span class="linenos">105</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector.mutual_information_selection-106"><a href="#FeatureSelector.mutual_information_selection-106"><span class="linenos">106</span></a><span class="sd">            list: Lista de características principales basadas en puntuaciones de información mutua.</span>
</span><span id="FeatureSelector.mutual_information_selection-107"><a href="#FeatureSelector.mutual_information_selection-107"><span class="linenos">107</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector.mutual_information_selection-108"><a href="#FeatureSelector.mutual_information_selection-108"><span class="linenos">108</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="FeatureSelector.mutual_information_selection-109"><a href="#FeatureSelector.mutual_information_selection-109"><span class="linenos">109</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="FeatureSelector.mutual_information_selection-110"><a href="#FeatureSelector.mutual_information_selection-110"><span class="linenos">110</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mi_scores</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector.mutual_information_selection-111"><a href="#FeatureSelector.mutual_information_selection-111"><span class="linenos">111</span></a>        <span class="k">return</span> <span class="n">mi_scores</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Selecciona características basadas en información mutua con la variable objetivo.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>X (pd.DataFrame):</strong>  Matriz de características para analizar.</li>
<li><strong>n_features (int, optional):</strong>  Número de características principales a seleccionar. 
Por defecto es 20.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: Lista de características principales basadas en puntuaciones de información mutua.</p>
</blockquote>
</div>


                            </div>
                            <div id="FeatureSelector.random_forest_importance" class="classattr">
                                        <input id="FeatureSelector.random_forest_importance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">random_forest_importance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">X</span>, </span><span class="param"><span class="n">n_features</span><span class="o">=</span><span class="mi">20</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureSelector.random_forest_importance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector.random_forest_importance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector.random_forest_importance-113"><a href="#FeatureSelector.random_forest_importance-113"><span class="linenos">113</span></a>    <span class="k">def</span> <span class="nf">random_forest_importance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
</span><span id="FeatureSelector.random_forest_importance-114"><a href="#FeatureSelector.random_forest_importance-114"><span class="linenos">114</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector.random_forest_importance-115"><a href="#FeatureSelector.random_forest_importance-115"><span class="linenos">115</span></a><span class="sd">        Selecciona características basadas en la importancia determinada por Random Forest.</span>
</span><span id="FeatureSelector.random_forest_importance-116"><a href="#FeatureSelector.random_forest_importance-116"><span class="linenos">116</span></a>
</span><span id="FeatureSelector.random_forest_importance-117"><a href="#FeatureSelector.random_forest_importance-117"><span class="linenos">117</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector.random_forest_importance-118"><a href="#FeatureSelector.random_forest_importance-118"><span class="linenos">118</span></a><span class="sd">            X (pd.DataFrame): Matriz de características para analizar.</span>
</span><span id="FeatureSelector.random_forest_importance-119"><a href="#FeatureSelector.random_forest_importance-119"><span class="linenos">119</span></a><span class="sd">            n_features (int, optional): Número de características principales a seleccionar. </span>
</span><span id="FeatureSelector.random_forest_importance-120"><a href="#FeatureSelector.random_forest_importance-120"><span class="linenos">120</span></a><span class="sd">                Por defecto es 20.</span>
</span><span id="FeatureSelector.random_forest_importance-121"><a href="#FeatureSelector.random_forest_importance-121"><span class="linenos">121</span></a>
</span><span id="FeatureSelector.random_forest_importance-122"><a href="#FeatureSelector.random_forest_importance-122"><span class="linenos">122</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector.random_forest_importance-123"><a href="#FeatureSelector.random_forest_importance-123"><span class="linenos">123</span></a><span class="sd">            list: Lista de características principales basadas en la importancia de Random Forest.</span>
</span><span id="FeatureSelector.random_forest_importance-124"><a href="#FeatureSelector.random_forest_importance-124"><span class="linenos">124</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector.random_forest_importance-125"><a href="#FeatureSelector.random_forest_importance-125"><span class="linenos">125</span></a>        <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="FeatureSelector.random_forest_importance-126"><a href="#FeatureSelector.random_forest_importance-126"><span class="linenos">126</span></a>        <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="FeatureSelector.random_forest_importance-127"><a href="#FeatureSelector.random_forest_importance-127"><span class="linenos">127</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span><span id="FeatureSelector.random_forest_importance-128"><a href="#FeatureSelector.random_forest_importance-128"><span class="linenos">128</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">importances</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector.random_forest_importance-129"><a href="#FeatureSelector.random_forest_importance-129"><span class="linenos">129</span></a>        <span class="k">return</span> <span class="n">importances</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">n_features</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Selecciona características basadas en la importancia determinada por Random Forest.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>X (pd.DataFrame):</strong>  Matriz de características para analizar.</li>
<li><strong>n_features (int, optional):</strong>  Número de características principales a seleccionar. 
Por defecto es 20.</li>
</ul>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: Lista de características principales basadas en la importancia de Random Forest.</p>
</blockquote>
</div>


                            </div>
                            <div id="FeatureSelector.plot_feature_importances" class="classattr">
                                        <input id="FeatureSelector.plot_feature_importances-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">plot_feature_importances</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">importances</span>, </span><span class="param"><span class="n">title</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureSelector.plot_feature_importances-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector.plot_feature_importances"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector.plot_feature_importances-131"><a href="#FeatureSelector.plot_feature_importances-131"><span class="linenos">131</span></a>    <span class="k">def</span> <span class="nf">plot_feature_importances</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">importances</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
</span><span id="FeatureSelector.plot_feature_importances-132"><a href="#FeatureSelector.plot_feature_importances-132"><span class="linenos">132</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector.plot_feature_importances-133"><a href="#FeatureSelector.plot_feature_importances-133"><span class="linenos">133</span></a><span class="sd">        Genera una gráfica de barras para visualizar la importancia de las características.</span>
</span><span id="FeatureSelector.plot_feature_importances-134"><a href="#FeatureSelector.plot_feature_importances-134"><span class="linenos">134</span></a>
</span><span id="FeatureSelector.plot_feature_importances-135"><a href="#FeatureSelector.plot_feature_importances-135"><span class="linenos">135</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector.plot_feature_importances-136"><a href="#FeatureSelector.plot_feature_importances-136"><span class="linenos">136</span></a><span class="sd">            importances (pd.Series): Series con las puntuaciones de importancia.</span>
</span><span id="FeatureSelector.plot_feature_importances-137"><a href="#FeatureSelector.plot_feature_importances-137"><span class="linenos">137</span></a><span class="sd">            title (str): Título para la gráfica.</span>
</span><span id="FeatureSelector.plot_feature_importances-138"><a href="#FeatureSelector.plot_feature_importances-138"><span class="linenos">138</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector.plot_feature_importances-139"><a href="#FeatureSelector.plot_feature_importances-139"><span class="linenos">139</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
</span><span id="FeatureSelector.plot_feature_importances-140"><a href="#FeatureSelector.plot_feature_importances-140"><span class="linenos">140</span></a>        <span class="n">importances</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector.plot_feature_importances-141"><a href="#FeatureSelector.plot_feature_importances-141"><span class="linenos">141</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</span><span id="FeatureSelector.plot_feature_importances-142"><a href="#FeatureSelector.plot_feature_importances-142"><span class="linenos">142</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Features&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector.plot_feature_importances-143"><a href="#FeatureSelector.plot_feature_importances-143"><span class="linenos">143</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Importance&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector.plot_feature_importances-144"><a href="#FeatureSelector.plot_feature_importances-144"><span class="linenos">144</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</span><span id="FeatureSelector.plot_feature_importances-145"><a href="#FeatureSelector.plot_feature_importances-145"><span class="linenos">145</span></a>        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Genera una gráfica de barras para visualizar la importancia de las características.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>importances (pd.Series):</strong>  Series con las puntuaciones de importancia.</li>
<li><strong>title (str):</strong>  Título para la gráfica.</li>
</ul>
</div>


                            </div>
                            <div id="FeatureSelector.select_features" class="classattr">
                                        <input id="FeatureSelector.select_features-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">select_features</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureSelector.select_features-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector.select_features"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector.select_features-147"><a href="#FeatureSelector.select_features-147"><span class="linenos">147</span></a>    <span class="k">def</span> <span class="nf">select_features</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="FeatureSelector.select_features-148"><a href="#FeatureSelector.select_features-148"><span class="linenos">148</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector.select_features-149"><a href="#FeatureSelector.select_features-149"><span class="linenos">149</span></a><span class="sd">        Ejecuta el pipeline completo de selección de características.</span>
</span><span id="FeatureSelector.select_features-150"><a href="#FeatureSelector.select_features-150"><span class="linenos">150</span></a>
</span><span id="FeatureSelector.select_features-151"><a href="#FeatureSelector.select_features-151"><span class="linenos">151</span></a><span class="sd">        Este método combina múltiples técnicas de selección:</span>
</span><span id="FeatureSelector.select_features-152"><a href="#FeatureSelector.select_features-152"><span class="linenos">152</span></a><span class="sd">        1. Filtrado por umbral de varianza</span>
</span><span id="FeatureSelector.select_features-153"><a href="#FeatureSelector.select_features-153"><span class="linenos">153</span></a><span class="sd">        2. Análisis de correlación</span>
</span><span id="FeatureSelector.select_features-154"><a href="#FeatureSelector.select_features-154"><span class="linenos">154</span></a><span class="sd">        3. Selección por información mutua</span>
</span><span id="FeatureSelector.select_features-155"><a href="#FeatureSelector.select_features-155"><span class="linenos">155</span></a><span class="sd">        4. Selección por importancia de Random Forest</span>
</span><span id="FeatureSelector.select_features-156"><a href="#FeatureSelector.select_features-156"><span class="linenos">156</span></a>
</span><span id="FeatureSelector.select_features-157"><a href="#FeatureSelector.select_features-157"><span class="linenos">157</span></a><span class="sd">        Returns:</span>
</span><span id="FeatureSelector.select_features-158"><a href="#FeatureSelector.select_features-158"><span class="linenos">158</span></a><span class="sd">            list: Lista final de nombres de características seleccionadas.</span>
</span><span id="FeatureSelector.select_features-159"><a href="#FeatureSelector.select_features-159"><span class="linenos">159</span></a>
</span><span id="FeatureSelector.select_features-160"><a href="#FeatureSelector.select_features-160"><span class="linenos">160</span></a><span class="sd">        Example:</span>
</span><span id="FeatureSelector.select_features-161"><a href="#FeatureSelector.select_features-161"><span class="linenos">161</span></a><span class="sd">            &gt;&gt;&gt; selector = FeatureSelector(&quot;data_directory&quot;)</span>
</span><span id="FeatureSelector.select_features-162"><a href="#FeatureSelector.select_features-162"><span class="linenos">162</span></a><span class="sd">            &gt;&gt;&gt; selected_features = selector.select_features()</span>
</span><span id="FeatureSelector.select_features-163"><a href="#FeatureSelector.select_features-163"><span class="linenos">163</span></a><span class="sd">            &gt;&gt;&gt; print(f&quot;Se seleccionaron {len(selected_features)} características&quot;)</span>
</span><span id="FeatureSelector.select_features-164"><a href="#FeatureSelector.select_features-164"><span class="linenos">164</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector.select_features-165"><a href="#FeatureSelector.select_features-165"><span class="linenos">165</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original number of features:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="FeatureSelector.select_features-166"><a href="#FeatureSelector.select_features-166"><span class="linenos">166</span></a>
</span><span id="FeatureSelector.select_features-167"><a href="#FeatureSelector.select_features-167"><span class="linenos">167</span></a>        <span class="c1"># 1. Variance Threshold</span>
</span><span id="FeatureSelector.select_features-168"><a href="#FeatureSelector.select_features-168"><span class="linenos">168</span></a>        <span class="n">var_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variance_threshold_selection</span><span class="p">()</span>
</span><span id="FeatureSelector.select_features-169"><a href="#FeatureSelector.select_features-169"><span class="linenos">169</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Features after variance threshold:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">var_selected</span><span class="p">))</span>
</span><span id="FeatureSelector.select_features-170"><a href="#FeatureSelector.select_features-170"><span class="linenos">170</span></a>
</span><span id="FeatureSelector.select_features-171"><a href="#FeatureSelector.select_features-171"><span class="linenos">171</span></a>        <span class="c1"># 2. Correlation Analysis</span>
</span><span id="FeatureSelector.select_features-172"><a href="#FeatureSelector.select_features-172"><span class="linenos">172</span></a>        <span class="n">corr_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">correlation_analysis</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">var_selected</span><span class="p">])</span>
</span><span id="FeatureSelector.select_features-173"><a href="#FeatureSelector.select_features-173"><span class="linenos">173</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Features after correlation analysis:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">corr_selected</span><span class="p">))</span>
</span><span id="FeatureSelector.select_features-174"><a href="#FeatureSelector.select_features-174"><span class="linenos">174</span></a>
</span><span id="FeatureSelector.select_features-175"><a href="#FeatureSelector.select_features-175"><span class="linenos">175</span></a>        <span class="c1"># 3. Mutual Information</span>
</span><span id="FeatureSelector.select_features-176"><a href="#FeatureSelector.select_features-176"><span class="linenos">176</span></a>        <span class="n">mi_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutual_information_selection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">])</span>
</span><span id="FeatureSelector.select_features-177"><a href="#FeatureSelector.select_features-177"><span class="linenos">177</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 20 features by mutual information:&quot;</span><span class="p">,</span> <span class="n">mi_selected</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-178"><a href="#FeatureSelector.select_features-178"><span class="linenos">178</span></a>
</span><span id="FeatureSelector.select_features-179"><a href="#FeatureSelector.select_features-179"><span class="linenos">179</span></a>        <span class="c1"># Plot mutual information scores</span>
</span><span id="FeatureSelector.select_features-180"><a href="#FeatureSelector.select_features-180"><span class="linenos">180</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">mutual_info_classif</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-181"><a href="#FeatureSelector.select_features-181"><span class="linenos">181</span></a>        <span class="n">mi_scores</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-182"><a href="#FeatureSelector.select_features-182"><span class="linenos">182</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature_importances</span><span class="p">(</span><span class="n">mi_scores</span><span class="p">,</span> <span class="s1">&#39;Mutual Information Scores&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-183"><a href="#FeatureSelector.select_features-183"><span class="linenos">183</span></a>
</span><span id="FeatureSelector.select_features-184"><a href="#FeatureSelector.select_features-184"><span class="linenos">184</span></a>        <span class="c1"># 4. Random Forest Feature Importance</span>
</span><span id="FeatureSelector.select_features-185"><a href="#FeatureSelector.select_features-185"><span class="linenos">185</span></a>        <span class="n">rf_selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_forest_importance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">])</span>
</span><span id="FeatureSelector.select_features-186"><a href="#FeatureSelector.select_features-186"><span class="linenos">186</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top 20 features by random forest importance:&quot;</span><span class="p">,</span> <span class="n">rf_selected</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-187"><a href="#FeatureSelector.select_features-187"><span class="linenos">187</span></a>
</span><span id="FeatureSelector.select_features-188"><a href="#FeatureSelector.select_features-188"><span class="linenos">188</span></a>        <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-189"><a href="#FeatureSelector.select_features-189"><span class="linenos">189</span></a>        <span class="n">rf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">y_encoded</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-190"><a href="#FeatureSelector.select_features-190"><span class="linenos">190</span></a>        <span class="n">importances</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">rf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="n">corr_selected</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-191"><a href="#FeatureSelector.select_features-191"><span class="linenos">191</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">plot_feature_importances</span><span class="p">(</span><span class="n">importances</span><span class="p">,</span> <span class="s1">&#39;Random Forest Feature Importance&#39;</span><span class="p">)</span>
</span><span id="FeatureSelector.select_features-192"><a href="#FeatureSelector.select_features-192"><span class="linenos">192</span></a>
</span><span id="FeatureSelector.select_features-193"><a href="#FeatureSelector.select_features-193"><span class="linenos">193</span></a>        <span class="n">combined_features</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">mi_selected</span> <span class="o">+</span> <span class="n">rf_selected</span><span class="p">))</span>
</span><span id="FeatureSelector.select_features-194"><a href="#FeatureSelector.select_features-194"><span class="linenos">194</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of features after combining MI and RF:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">combined_features</span><span class="p">))</span>
</span><span id="FeatureSelector.select_features-195"><a href="#FeatureSelector.select_features-195"><span class="linenos">195</span></a>
</span><span id="FeatureSelector.select_features-196"><a href="#FeatureSelector.select_features-196"><span class="linenos">196</span></a>        <span class="k">return</span> <span class="n">combined_features</span>
</span></pre></div>


            <div class="docstring"><p>Ejecuta el pipeline completo de selección de características.</p>

<p>Este método combina múltiples técnicas de selección:</p>

<ol>
<li>Filtrado por umbral de varianza</li>
<li>Análisis de correlación</li>
<li>Selección por información mutua</li>
<li>Selección por importancia de Random Forest</li>
</ol>

<h6 id="returns">Returns:</h6>

<blockquote>
  <p>list: Lista final de nombres de características seleccionadas.</p>
</blockquote>

<h6 id="example">Example:</h6>

<blockquote>
  <div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">selector</span> <span class="o">=</span> <span class="n">FeatureSelector</span><span class="p">(</span><span class="s2">&quot;data_directory&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">selected_features</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">select_features</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Se seleccionaron </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">selected_features</span><span class="p">)</span><span class="si">}</span><span class="s2"> características&quot;</span><span class="p">)</span>
</code></pre>
  </div>
</blockquote>
</div>


                            </div>
                            <div id="FeatureSelector.save_selected_features" class="classattr">
                                        <input id="FeatureSelector.save_selected_features-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">save_selected_features</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">selected_features</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="FeatureSelector.save_selected_features-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FeatureSelector.save_selected_features"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FeatureSelector.save_selected_features-198"><a href="#FeatureSelector.save_selected_features-198"><span class="linenos">198</span></a>    <span class="k">def</span> <span class="nf">save_selected_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">selected_features</span><span class="p">):</span>
</span><span id="FeatureSelector.save_selected_features-199"><a href="#FeatureSelector.save_selected_features-199"><span class="linenos">199</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FeatureSelector.save_selected_features-200"><a href="#FeatureSelector.save_selected_features-200"><span class="linenos">200</span></a><span class="sd">        Guarda las características seleccionadas en un archivo CSV.</span>
</span><span id="FeatureSelector.save_selected_features-201"><a href="#FeatureSelector.save_selected_features-201"><span class="linenos">201</span></a>
</span><span id="FeatureSelector.save_selected_features-202"><a href="#FeatureSelector.save_selected_features-202"><span class="linenos">202</span></a><span class="sd">        Args:</span>
</span><span id="FeatureSelector.save_selected_features-203"><a href="#FeatureSelector.save_selected_features-203"><span class="linenos">203</span></a><span class="sd">            selected_features (list): Lista de nombres de características a guardar.</span>
</span><span id="FeatureSelector.save_selected_features-204"><a href="#FeatureSelector.save_selected_features-204"><span class="linenos">204</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FeatureSelector.save_selected_features-205"><a href="#FeatureSelector.save_selected_features-205"><span class="linenos">205</span></a>        <span class="n">final_df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="n">selected_features</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]]</span>
</span><span id="FeatureSelector.save_selected_features-206"><a href="#FeatureSelector.save_selected_features-206"><span class="linenos">206</span></a>        <span class="n">final_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</span><span id="FeatureSelector.save_selected_features-207"><a href="#FeatureSelector.save_selected_features-207"><span class="linenos">207</span></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature selection completed. Selected features saved to &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">feature_selected_data_path</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
</span><span id="FeatureSelector.save_selected_features-208"><a href="#FeatureSelector.save_selected_features-208"><span class="linenos">208</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Final selected features:&quot;</span><span class="p">)</span>
</span><span id="FeatureSelector.save_selected_features-209"><a href="#FeatureSelector.save_selected_features-209"><span class="linenos">209</span></a>        <span class="nb">print</span><span class="p">(</span><span class="n">selected_features</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Guarda las características seleccionadas en un archivo CSV.</p>

<h6 id="arguments">Arguments:</h6>

<ul>
<li><strong>selected_features (list):</strong>  Lista de nombres de características a guardar.</li>
</ul>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>